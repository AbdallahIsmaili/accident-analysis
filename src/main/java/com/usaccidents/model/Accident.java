package com.usaccidents.model;

public class Accident {
    private String source;
    private int severity;
    private String startTime;
    private String endTime;
    private double startLat;
    private double startLng;
    private double distanceMi;
    private String description;
    private String street;
    private String city;
    private String county;
    private String state;
    private String zipcode;
    private String country;
    private String timezone;
    private String airportCode;
    private Double temperatureF;
    private Double windChillF;
    private Double humidityPercent;
    private Double pressureIn;
    private Double visibilityMi;
    private String windDirection;
    private Double windSpeedMph;
    private Double precipitationIn;
    private String weatherCondition;
    private String amenity;
    private String bump;
    private String crossing;
    private String giveWay;
    private String junction;
    private String noExit;
    private String railway;
    private String roundabout;
    private String station;
    private String stop;
    private String trafficCalming;
    private String trafficSignal;
    private String turningLoop;
    private String sunriseSunset;
    private String civilTwilight;
    private String nauticalTwilight;
    private String astronomicalTwilight;
    private String id;
    private String weatherTimestampFilled;

    // Getters and setters for all fields
    public String getSource() { return source; }
    public void setSource(String source) { this.source = source; }

    public int getSeverity() { return severity; }
    public void setSeverity(int severity) { this.severity = severity; }

    public String getStartTime() { return startTime; }
    public void setStartTime(String startTime) { this.startTime = startTime; }

    public String getEndTime() { return endTime; }
    public void setEndTime(String endTime) { this.endTime = endTime; }

    public double getStartLat() { return startLat; }
    public void setStartLat(double startLat) { this.startLat = startLat; }

    public double getStartLng() { return startLng; }
    public void setStartLng(double startLng) { this.startLng = startLng; }

    public double getDistanceMi() { return distanceMi; }
    public void setDistanceMi(double distanceMi) { this.distanceMi = distanceMi; }

    public String getDescription() { return description; }
    public void setDescription(String description) { this.description = description; }

    public String getStreet() { return street; }
    public void setStreet(String street) { this.street = street; }

    public String getCity() { return city; }
    public void setCity(String city) { this.city = city; }

    public String getCounty() { return county; }
    public void setCounty(String county) { this.county = county; }

    public String getState() { return state; }
    public void setState(String state) { this.state = state; }

    public String getZipcode() { return zipcode; }
    public void setZipcode(String zipcode) { this.zipcode = zipcode; }

    public String getCountry() { return country; }
    public void setCountry(String country) { this.country = country; }

    public String getTimezone() { return timezone; }
    public void setTimezone(String timezone) { this.timezone = timezone; }

    public String getAirportCode() { return airportCode; }
    public void setAirportCode(String airportCode) { this.airportCode = airportCode; }

    public Double getTemperatureF() { return temperatureF; }
    public void setTemperatureF(Double temperatureF) { this.temperatureF = temperatureF; }

    public Double getWindChillF() { return windChillF; }
    public void setWindChillF(Double windChillF) { this.windChillF = windChillF; }

    public Double getHumidityPercent() { return humidityPercent; }
    public void setHumidityPercent(Double humidityPercent) { this.humidityPercent = humidityPercent; }

    public Double getPressureIn() { return pressureIn; }
    public void setPressureIn(Double pressureIn) { this.pressureIn = pressureIn; }

    public Double getVisibilityMi() { return visibilityMi; }
    public void setVisibilityMi(Double visibilityMi) { this.visibilityMi = visibilityMi; }

    public String getWindDirection() { return windDirection; }
    public void setWindDirection(String windDirection) { this.windDirection = windDirection; }

    public Double getWindSpeedMph() { return windSpeedMph; }
    public void setWindSpeedMph(Double windSpeedMph) { this.windSpeedMph = windSpeedMph; }

    public Double getPrecipitationIn() { return precipitationIn; }
    public void setPrecipitationIn(Double precipitationIn) { this.precipitationIn = precipitationIn; }

    public String getWeatherCondition() { return weatherCondition; }
    public void setWeatherCondition(String weatherCondition) { this.weatherCondition = weatherCondition; }

    public String getAmenity() { return amenity; }
    public void setAmenity(String amenity) { this.amenity = amenity; }

    public String getBump() { return bump; }
    public void setBump(String bump) { this.bump = bump; }

    public String getCrossing() { return crossing; }
    public void setCrossing(String crossing) { this.crossing = crossing; }

    public String getGiveWay() { return giveWay; }
    public void setGiveWay(String giveWay) { this.giveWay = giveWay; }

    public String getJunction() { return junction; }
    public void setJunction(String junction) { this.junction = junction; }

    public String getNoExit() { return noExit; }
    public void setNoExit(String noExit) { this.noExit = noExit; }

    public String getRailway() { return railway; }
    public void setRailway(String railway) { this.railway = railway; }

    public String getRoundabout() { return roundabout; }
    public void setRoundabout(String roundabout) { this.roundabout = roundabout; }

    public String getStation() { return station; }
    public void setStation(String station) { this.station = station; }

    public String getStop() { return stop; }
    public void setStop(String stop) { this.stop = stop; }

    public String getTrafficCalming() { return trafficCalming; }
    public void setTrafficCalming(String trafficCalming) { this.trafficCalming = trafficCalming; }

    public String getTrafficSignal() { return trafficSignal; }
    public void setTrafficSignal(String trafficSignal) { this.trafficSignal = trafficSignal; }

    public String getTurningLoop() { return turningLoop; }
    public void setTurningLoop(String turningLoop) { this.turningLoop = turningLoop; }

    public String getSunriseSunset() { return sunriseSunset; }
    public void setSunriseSunset(String sunriseSunset) { this.sunriseSunset = sunriseSunset; }

    public String getCivilTwilight() { return civilTwilight; }
    public void setCivilTwilight(String civilTwilight) { this.civilTwilight = civilTwilight; }

    public String getNauticalTwilight() { return nauticalTwilight; }
    public void setNauticalTwilight(String nauticalTwilight) { this.nauticalTwilight = nauticalTwilight; }

    public String getAstronomicalTwilight() { return astronomicalTwilight; }
    public void setAstronomicalTwilight(String astronomicalTwilight) { this.astronomicalTwilight = astronomicalTwilight; }

    public String getId() { return id; }
    public void setId(String id) { this.id = id; }

    public String getWeatherTimestampFilled() { return weatherTimestampFilled; }
    public void setWeatherTimestampFilled(String weatherTimestampFilled) { this.weatherTimestampFilled = weatherTimestampFilled; }

    // 1. Obtenir l'heure de la journée à partir de startTime
    public int getHourOfDay() {
        try {
            java.time.LocalDateTime start = java.time.LocalDateTime.parse(this.startTime.replace(" ", "T"));
            return start.getHour();
        } catch (Exception e) {
            return -1; // Erreur de parsing
        }
    }

    // 2. Obtenir le jour de la semaine à partir de startTime
    public String getDayOfWeek() {
        try {
            java.time.LocalDateTime start = java.time.LocalDateTime.parse(this.startTime.replace(" ", "T"));
            return start.getDayOfWeek().toString(); // Ex: MONDAY, TUESDAY
        } catch (Exception e) {
            return "UNKNOWN";
        }
    }

    // 3. Savoir si l'accident a eu lieu la nuit (avant 6h ou après 20h)
    public boolean isNightAccident() {
        try {
            int hour = getHourOfDay();
            return (hour >= 0 && hour < 6) || (hour >= 20 && hour <= 23);
        } catch (Exception e) {
            return false;
        }
    }

    // 4. Vérifier si les conditions météo sont défavorables
    public boolean hasBadWeather() {
        if (weatherCondition == null) return false;

        String condition = weatherCondition.toLowerCase();
        return condition.contains("rain") || condition.contains("snow") || condition.contains("storm") || condition.contains("fog");
    }

    // 6. Comparaison par gravité (severity)
    public int compareBySeverity(Accident other) {
        return Integer.compare(this.severity, other.severity);
    }

    // 7. Comparaison par date
    public int compareByDate(Accident other) {
        try {
            java.time.LocalDateTime thisDate = java.time.LocalDateTime.parse(this.startTime.replace(" ", "T"));
            java.time.LocalDateTime otherDate = java.time.LocalDateTime.parse(other.startTime.replace(" ", "T"));
            return thisDate.compareTo(otherDate);
        } catch (Exception e) {
            return 0;
        }
    }

    // 8. Calculer la durée de l'accident en minutes
    public long getDurationMinutes() {
        try {
            java.time.LocalDateTime start = java.time.LocalDateTime.parse(this.startTime.replace(" ", "T"));
            java.time.LocalDateTime end = java.time.LocalDateTime.parse(this.endTime.replace(" ", "T"));
            return java.time.Duration.between(start, end).toMinutes();
        } catch (Exception e) {
            return -1;
        }
    }

    // 9. Convertir la température de Fahrenheit en Celsius
    public Double getTemperatureC() {
        if (temperatureF == null) return null;
        return (temperatureF - 32) * 5 / 9;
    }

    // 10. Vérifier si l'accident est dans une zone urbaine (ex: ville non nulle ou "urban" dans description)
    public boolean isUrbanArea() {
        if (city != null && !city.isEmpty()) return true;
        if (description != null && description.toLowerCase().contains("urban")) return true;
        return false;
    }

    // 11. Savoir si l'accident a eu lieu sur une intersection (junction ou trafficSignal)
    public boolean isAtIntersection() {
        return ("true".equalsIgnoreCase(junction) || "true".equalsIgnoreCase(trafficSignal));
    }

    // 12. Afficher un résumé complet des conditions météo (temps, vent, précipitations)
    public String getWeatherSummary() {
        return String.format("Temp: %s°F (%.1f°C), Wind: %s mph from %s, Precipitation: %s in, Condition: %s",
                temperatureF == null ? "N/A" : temperatureF.toString(),
                getTemperatureC() == null ? 0 : getTemperatureC(),
                windSpeedMph == null ? "N/A" : windSpeedMph.toString(),
                windDirection == null ? "N/A" : windDirection,
                precipitationIn == null ? "N/A" : precipitationIn.toString(),
                weatherCondition == null ? "N/A" : weatherCondition);
    }

    @Override
    public String toString() {
        return "Accident{" +
                "id='" + id + '\'' +
                ", severity=" + severity +
                ", startTime='" + startTime + '\'' +
                ", city='" + city + '\'' +
                ", description='" + description + '\'' +
                '}';
    }
}